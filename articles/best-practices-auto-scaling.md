<properties
   pageTitle="Guía de ajuste automático | Microsoft Azure"
   description="Instrucciones para ajustar automáticamente al asignar dinámicamente recursos requeridos una aplicación."
   services=""
   documentationCenter="na"
   authors="dragon119"
   manager="christb"
   editor=""
   tags=""/>

<tags
   ms.service="best-practice"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="07/13/2016"
   ms.author="masashin"/>

# <a name="autoscaling-guidance"></a>Guía de ajuste automático

[AZURE.INCLUDE [pnp-header](../includes/guidance-pnp-header-include.md)]

## <a name="overview"></a>Información general
Ajuste automático es el proceso de asignar dinámicamente los recursos que requiere una aplicación para que coincidan con los requisitos de rendimiento y cumplir con los contratos de nivel de servicio (SLA), mientras minimiza los costos de tiempo de ejecución. A medida que crece el volumen de trabajo, una aplicación puede requerir recursos adicionales para que pueda realizar sus tareas de forma oportuna. Como slackens demanda, los recursos pueden ser desasignados para minimizar los costos, y aún mantener un rendimiento adecuado y SLA de la reunión.
Ajuste automático aprovecha la elasticidad de entornos hospedada en la nube mientras aceleración sobrecarga de administración. Para ello, se reduce la necesidad de un operador continuamente supervisar el rendimiento de un sistema y tomar decisiones sobre cómo agregar o quitar recursos.
>[AZURE.NOTE] Ajuste automático se aplica a todos los recursos utilizados por una aplicación, no solo los recursos de cálculo. Por ejemplo, si el sistema utiliza colas de mensajes para enviar y recibir información, podría crear colas adicionales como escala.

## <a name="types-of-scaling"></a>Tipos de escala
Escala normalmente tiene una de las dos formas siguientes:

- **Vertical** (a menudo denominados _escalado hacia arriba y abajo_). Este formulario requiere que se modifique el hardware (expandir o reducir su capacidad y el rendimiento), o volver a implementar la solución utilizando hardware alternativo que tiene la capacidad apropiada y el rendimiento. En un entorno de nube, la plataforma de hardware suele ser un entorno virtualizado. A menos que el hardware original se overprovisioned considerablemente con el gasto de capital inicial consecutivas, escalado verticalmente en este entorno implica aprovisionamiento recursos más eficaces y, a continuación, mover el sistema en estos nuevos recursos. Escala vertical a menudo es un proceso de interrupciones que requiere que el sistema no esté disponible temporalmente mientras se que se vuelve a implementar. Es posible evitar que el sistema original ejecutando mientras el hardware nuevo se aprovisiona y poner en línea, pero hay probablemente será algunas interrupciones mientras las transiciones de procesamiento del entorno antiguo al nuevo. Es extraño usar ajuste automático para implementar una estrategia de escalado vertical.
- **Horizontal** (a menudo denominados _escala y en_). Este formulario requiere implementar la solución en más o menos recursos, que normalmente son recursos de mercancías en lugar de sistemas de gran potencia. La solución puede continuar ejecutándose sin interrupciones mientras se aprovisiona estos recursos. Una vez completado el proceso de aprovisionamiento, copias de los elementos que componen la solución se pueden implementar en estos recursos adicionales y disponibles. Si quita la petición, pueden reclamar los recursos adicionales después de los elementos con ellos se ha cerrado sin errores. Muchos sistemas basados en la nube, incluidos Microsoft Azure, admiten la automatización de este formulario de escala.

## <a name="implement-an-autoscaling-strategy"></a>Implementar una estrategia de ajuste automático
Implementar una estrategia de ajuste automático normalmente implica los siguientes componentes y procesos:

- Instrumentación y sistemas en los niveles de aplicación, el servicio y la infraestructura de supervisión. Estos sistemas capturan métricas clave, como los tiempos de respuesta, longitudes de cola, uso de CPU y uso de memoria.
- Lógica de toma de decisiones que puede evaluar los factores de escala supervisados contra umbrales de sistema predefinidas o programaciones y decidir si desea cambiar la escala o no.
- Componentes que son responsables de llevar a cabo tareas asociadas con la escala del sistema, como aprovisionamiento o anular el aprovisionamiento de recursos.
- Probar, supervisión y ajuste de la estrategia de ajuste automático para asegurarse de que funciona como se esperaba.

Mayoría entornos de nube, como Azure, proporcionan mecanismos de ajuste automático integrados que escenarios comunes de dirección. Si no proporciona el entorno o servicio que utiliza que el necesario automatizado funcionalidad escala, o si tiene requisitos de ajuste automático extremas sus posibilidades, una implementación personalizada puede ser necesaria. Use esta implementación personalizada para recopilar operativas y medidas del sistema, analizarlos para identificar información relevante y, a continuación, escalar recursos en consecuencia.


## <a name="configure-autoscaling-for-an-azure-solution"></a>Configurar ajuste automático para una solución de Azure
Hay varias opciones para configurar el ajuste automático para las soluciones de Azure:

- **Autoescala de Azure** es compatible con los escenarios más comunes de escala basada en una programación y, opcionalmente, activa escala operaciones basadas en métricas de runtime (como la utilización del procesador, longitud de la cola o contadores integrados y personalizados). Puede configurar directivas de ajuste automático simple para una solución rápida y fácilmente a través del portal de Azure. Para obtener más control, puede hacer que el uso de la [API de REST de administración de servicio de Azure](https://msdn.microsoft.com/library/azure/ee460799.aspx) o la [REST API de administrador de recursos de Azure](https://msdn.microsoft.com//library/azure/dn790568.aspx). La [Biblioteca de administración de servicio de supervisión de Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring) y la [Biblioteca de información de Microsoft](https://www.nuget.org/packages/Microsoft.Azure.Insights/) (en vista preliminar) son SDK que permiten la recopilación de métricas de diferentes recursos y realizan ajusta automáticamente mediante el uso de las API de REST. Para los recursos en los que no está disponible la compatibilidad con el Administrador de recursos de Azure, o si está utilizando servicios de nube de Azure, la API de REST de administración de servicio puede usarse para el ajuste automático. En todos los demás casos, use el Administrador de recursos de Azure.
- **Una solución personalizada**, en función de la instrumentación en la aplicación y las características de administración de Azure, puede ser útil. Por ejemplo, podría usar otros métodos de instrumentación o diagnóstico de Azure en la aplicación, junto con código personalizado para supervisar continuamente y exportar métricas de la aplicación. Podría tener reglas personalizadas que funcionan en estas métricas y utilizar la administración del servicio o de la REST API de administrador de recursos desencadenar ajusta automáticamente. Las mediciones para la activación de una operación de escala pueden ser cualquier contador personalizado o integrado u otra instrumentación que implementar dentro de la aplicación. Sin embargo, una solución personalizada no es fácil de implementar y se debe considerar sólo si ninguno de los métodos anteriores puede satisfacer sus necesidades. El [Bloque de aplicaciones de ajuste automático](http://msdn.microsoft.com/library/hh680892%28v=pandp.50%29.aspx) utiliza este método.
- **Servicios de terceros**, como [Paraleap AzureWatch](http://www.paraleap.com/AzureWatch), le permiten escalar una solución basada en las programaciones, los indicadores de rendimiento de carga y el sistema de servicio, reglas personalizadas y combinaciones de los diferentes tipos de reglas.

Al elegir la solución de ajuste automático adoptar, tenga en cuenta los siguientes puntos:

- Usar las características de ajuste automático integrados de la plataforma, si puede cumplen los requisitos. Si no es así, considere detenidamente si realmente necesita características escaladas más complejas. Algunos ejemplos de requisitos adicionales pueden incluir más detalle de control de diferentes formas para detectar los eventos de desencadenador para la escala, la escala en todas las suscripciones y otros tipos de recursos de ajuste de escala.
- Tenga en cuenta si puede prever la carga de la aplicación con una precisión suficiente de dependen solo ajusta automáticamente programada (agregar y quitar instancias para satisfacer puntos máximos anticipados). Donde no es posible, use reactiva ajusta automáticamente en función de métricas en tiempo de ejecución para permitir que la aplicación para controlar los cambios imprevistos en la demanda. Normalmente, puede combinar estos métodos. Por ejemplo, crear una estrategia que agrega recursos como cálculo, almacenamiento y colas, en función de una programación de las horas cuando se sabe que la aplicación es más ocupada. Esto ayuda a garantizar que capacidad está disponible cuando sea necesario, sin el retraso al iniciar nuevas instancias. Además, para cada regla programada, definir métricas que permiten ajuste automático reactiva durante ese período para asegurarse de que la aplicación puede controlar prolongados pero imprevistos puntos máximos.
- A menudo es difícil de comprender la relación entre los requisitos de capacidad y métricas, especialmente cuando se implementa una aplicación. Prefiere aprovisionar un poco capacidad adicional al principio y, a continuación, supervisar y ajustar las reglas de ajuste automático para poner la capacidad más cerca a la carga real.

### <a name="use-azure-autoscale"></a>Usar Autoescala de Azure
Autoescala le permite configurar escala horizontal y escala en Opciones para una solución. Autoescala automáticamente puede agregar y quitar instancias de web de servicios de nube de Azure y roles de trabajo, servicios de móvil de Azure y característica de aplicaciones Web de servicio de aplicaciones de Azure. También puede habilitar el ajuste de escala automático en iniciar y detener instancias de Azure máquinas virtuales de Windows. Una estrategia de ajuste automático de Azure incluye dos conjuntos de factores:

- Ajuste automático basado en la programación que puede asegurarse de que instancias adicionales están disponible para que coincidan con un máximo de uso esperado y puede escalar en una vez que ha pasado el tiempo máximo. Esto le permite asegurarse de que tiene suficientes instancias ya en ejecución, sin tener que esperar para que el sistema ante la carga.
- Ajuste automático basado en mediciones que reaccione a factores como el uso de CPU promedio sobre la última hora o el trabajo acumulado de los mensajes que está procesando la solución en un almacenamiento de Azure o una cola de Bus de servicio de Azure. Esto permite a la aplicación reaccionar por separado de las reglas de ajuste automático programada para acomodar planeados o imprevistos cambios en la demanda.

Cuando se usa Autoescala, tenga en cuenta los siguientes puntos:

- La estrategia de ajuste automático combina programada y basadas en métricas escala. Puede especificar dos tipos de reglas de un servicio.
- Debe configurar las reglas de ajuste automático y, a continuación, supervisar el rendimiento de la aplicación a lo largo del tiempo. Utilizar los resultados de dicho seguimiento para ajustar el modo en que el sistema de escala si es necesario. Sin embargo, tenga en cuenta que ajuste automático no es un proceso instantáneo. Tiempo ante una métrica como promedio CPU utilización sobrepasan (o no) un umbral especificado.
- Las reglas de ajuste automático que usan un mecanismo de detección basado en un atributo medido desencadenador (por ejemplo, la longitud de cola o uso de CPU) use un valor agregado sobre el tiempo, en lugar de valores instantáneos, para activar una acción de ajuste automático. De forma predeterminada, el agregado es un promedio de los valores. Esto impide que el sistema de reaccionar demasiado rápido o causando oscilación rápida. También permite tiempo para nuevas instancias están iniciados automáticamente para liquidar en modo, acciones adicionales de ajuste automático se produzca mientras están iniciando las nuevas instancias de prevención de ejecución. Para los servicios de nube de Azure y máquinas virtuales de Azure, el período predeterminado para la agregación es 45 minutos, así que puede tardar hasta a este período de tiempo para la métrica desencadenar ajusta automáticamente en respuesta a picos de demanda. Puede cambiar el período de agregación mediante el SDK, pero tenga en cuenta que los períodos de menos de 25 minutos pueden provocar resultados inesperados (para obtener más información, consulte [Servicios de nube escala automático en porcentaje de CPU con la biblioteca de administración de servicios de supervisión de Azure](http://rickrainey.com/2013/12/15/auto-scaling-cloud-services-on-cpu-percentage-with-the-windows-azure-monitoring-services-management-library/)). Para las aplicaciones Web, el período de promedio es mucho más corto, lo que permite nuevas instancias esté disponible en unos cinco minutos después de un cambio en la medida de desencadenador promedio.
- Si configura ajusta automáticamente mediante el SDK en lugar de en el portal web, puede especificar una programación más detallada durante el cual las reglas están activas. También puede crear sus propio métricas y usarlos con o sin ninguna de las existentes en las reglas de ajuste automático. Por ejemplo, puede utilizar contadores alternativos, como el número de solicitudes por segundo o la disponibilidad de memoria promedio, o contadores personalizados que miden determinados procesos de negocio.
- Cuando se ajusta automáticamente en máquinas virtuales de Azure, debe implementar un número de instancias de la máquina virtual que es igual a la cantidad máxima le permitirá ajusta automáticamente al iniciar. Estas instancias deben ser parte del mismo conjunto de disponibilidad. El mecanismo de ajuste automático de máquinas virtuales no crear ni eliminar instancias de la máquina virtual. en su lugar, las reglas de ajuste automático que configurar se iniciará y dejar un número adecuado de estas instancias. Para obtener más información, vea [cambiar automáticamente la escala de una aplicación con funciones Web, funciones de trabajo o máquinas virtuales de Windows](./cloud-services/cloud-services-how-to-scale.md).
- Si no se puede iniciar nuevas instancias, quizás porque se ha alcanzado el número máximo de una suscripción o se produce un error durante el inicio, el portal puede mostrar que se realizó correctamente una operación de ajuste automático. Sin embargo, los eventos de **ChangeDeploymentConfiguration** aparece en el portal de mostrar solo que se ha solicitado un inicio de servicio y no habrá ningún evento para indicar que se ha completado correctamente.
- Puede usar la interfaz de usuario del portal web al que para vincular recursos como instancias de base de datos SQL y colas de una instancia de servicio de cálculo. Esto le permite tener acceso más fácilmente el separar manual o automático de opciones de configuración para cada uno de los recursos vinculados de escala. Para obtener más información, vea [Cómo: vincular un recurso a un servicio de nube](cloud-services-how-to-manage.md#linkresources) y [cómo ajustar el tamaño de una aplicación](./cloud-services/cloud-services-how-to-scale.md).
- Al configurar varias directivas y las reglas, podría entran en conflicto entre sí. Autoescala usa las siguientes reglas de resolución de conflictos para asegurarse de que siempre hay un número suficiente de instancias que se ejecutan:
  - Escala de operaciones siempre tiene prioridad sobre escala en las operaciones.
  - Conflicto de operaciones cuando escalar, tiene prioridad la regla que inicia el mayor aumento en el número de instancias.
  - Cuando ajustar en conflicto de operaciones, la regla que inicia el menor reducción del número de instancias tiene prioridad.

<a name="the-azure-monitoring-services-management-library"></a>

## <a name="application-design-considerations-for-implementing-autoscaling"></a>Consideraciones de diseño de la aplicación para la implementación de ajuste automático
Ajuste automático no es una solución instantánea. Agregar recursos a un sistema simplemente o más instancias de un proceso en ejecución no garantizan que mejorará el rendimiento del sistema. Al diseñar una estrategia de ajuste automático, tenga en cuenta los siguientes puntos:

- El sistema se debe diseñado para ser escalabilidad horizontal. Evitar hacer suposiciones sobre afinidad de instancia; debe diseñar las soluciones que requieren que el código siempre se ejecuta en una instancia específica de un proceso. Si la escala de un sitio web o un servicio de nube horizontalmente, no se supone que una serie de solicitudes de la misma fuente siempre se se dirigen a la misma instancia. Por el mismo motivo, servicios independiente para evitar que requieren una serie de solicitudes de una aplicación para que siempre se dirigen a la misma instancia de un servicio de diseño. Cuando diseñe un servicio que lee mensajes de una cola y procesa, no realizar ninguna suposición sobre qué instancia de los controladores de servicio un mensaje específico. A medida que crece la longitud de cola se ajusta automáticamente pudo iniciar más instancias de un servicio. La [Trama de los consumidores competir](http://msdn.microsoft.com/library/dn568101.aspx) describe cómo manejar este escenario.
- Si la solución implementa una tarea de ejecución larga, diseño que admiten escalado y ajuste de escala en esta tarea. Sin vencimiento atención, esta tarea podría impedir que se cierra sin problemas cuando el sistema se escala en una instancia de un proceso o podrían perder datos si forzar finaliza el proceso. Lo ideal es refactorizar una tarea de ejecución larga y dividir el procesamiento que realiza en fragmentos más pequeños, discretas. [Patrón de filtros y canalizaciones](http://msdn.microsoft.com/library/dn568100.aspx) proporciona un ejemplo de cómo se puede conseguir.
- Como alternativa, puede implementar un mecanismo de comprobación que registros información acerca de la tarea a intervalos regulares de estado y guardar este estado de almacenamiento resistente que puede tener acceso a cualquier instancia del proceso de ejecución de la tarea. De este modo, si el proceso se cierra, el trabajo que estaba realizando se puede reanudar desde el último punto de comprobación utilizando otra instancia.
- Cuando tareas en segundo plano se ejecutan en instancias de cálculo independiente, como en el trabajo roles de los servicios de nube hospedan aplicación, debe escalar distintas partes de la aplicación con diferentes directivas de escala. Por ejemplo, tendrá que implementar de cálculo de la interfaz de usuario adicionales instancias sin aumentar el número de fondo calculan instancias o lo opuesto a esto. Si ofrece diferentes niveles de servicio (por ejemplo, paquetes de servicio básico y premium), debe ajustar los recursos de cálculo para los paquetes de servicio premium más agresiva que los paquetes de servicio básico para cumplir el SLA.
- Considere la posibilidad de usar la longitud de la cola sobre qué interfaz de usuario y fondo calculan instancias comunican como criterio para su estrategia de ajuste automático. Este es el mejor indicador de un descuadre o la diferencia entre la carga y la capacidad de procesamiento de la tarea en segundo plano.
- Si basa la estrategia de ajuste automático en encarga procesos empresariales, como el número de pedidos por hora o el tiempo de ejecución promedio de una transacción compleja, asegúrese de que comprende perfectamente la relación entre los resultados de estos tipos de contadores y los requisitos de capacidad de cálculo real. Puede ser necesario calcular la unidad en respuesta a cambios en contadores de proceso de negocio o escala más de un componente.  
- Para impedir que un sistema intente escalar excesiva y para evitar los costos asociados con la ejecución de miles de instancias, considere la posibilidad de limitar el número máximo de instancias que se pueden agregar automáticamente. La mayoría de los mecanismos de ajuste automático le permiten especificar el número máximo y mínimo de instancias de una regla. Además, considere la posibilidad de degradar correctamente la funcionalidad que proporciona el sistema si se han implementado el número máximo de instancias y aún se sobrecarga el sistema.
- Tenga en cuenta que ajuste automático no sea el mecanismo más adecuado para controlar una ráfaga rápida de carga de trabajo. Tiempo de aprovisionar e iniciar nuevas instancias de un servicio o agregar recursos a un sistema y, a continuación, puede haber pasado la demanda de recursos asignadas en el momento en que se han realizado estos recursos adicionales disponibles. En este escenario, puede ser mejor limitar el servicio. Para obtener más información, vea la [Limitación de trama](http://msdn.microsoft.com/library/dn589798.aspx).
- Por el contrario, si necesita la capacidad para procesar todas las solicitudes cuando el volumen varía rápidamente y costo no es un factor importante colaborador, considere la posibilidad de usar una estrategia de ajuste automático agresiva que se inicia más instancias más rápidamente. También puede usar una política programada que se inicia un número suficiente de instancias para cumplir con la carga máxima antes de que la carga se espera.
- El mecanismo de ajuste automático debe supervisar el proceso de ajuste automático y registrar los detalles de cada evento de ajuste automático (lo que lo haya desencadenado, los recursos que se agregaron o quitaron y cuándo). Si crea un mecanismo de ajuste automático personalizado, asegúrese de que incorpora esta capacidad. Analizar la información para ayudar a medir la eficacia de la estrategia de ajuste automático y personalícelo si es necesario. Puede ajustar tanto a corto plazo, a medida que los patrones de uso más obvios y excedido a largo plazo, tal como se expande la empresa o cambien las necesidades de la aplicación. Si una aplicación alcanza el límite superior definido para el ajuste automático, el mecanismo también puede alertar a un operador que podría iniciar manualmente recursos adicionales si es necesario. Tenga en cuenta que, en estas circunstancias, el operador también puede ser responsable de quitar manualmente estos recursos después facilita la carga de trabajo.

## <a name="related-patterns-and-guidance"></a>Orientación y patrones relacionados
Los patrones y las instrucciones siguientes también pueden relevantes para su situación al implementar ajuste automático:

- [Límite de trama](http://msdn.microsoft.com/library/dn589798.aspx). Este patrón describe cómo puede seguir una aplicación de función y cumple los SLA cuando un aumento de petición coloca una carga extrema en recursos. Límite de puede usarse con ajuste automático para evitar que un sistema de está abrumado mientras el sistema se escala.
- [Una competición de trama de consumidores](http://msdn.microsoft.com/library/dn568101.aspx). Este patrón describe cómo implementar un grupo de instancias de servicio que puede controlar los mensajes de instancia de la aplicación. Ajuste automático puede utilizarse para iniciar y detener instancias del servicio para que coincida con la carga de trabajo previsto. Este enfoque permite un sistema de varios mensajes al mismo tiempo para optimizar el rendimiento, mejorar la disponibilidad y escalabilidad y equilibrar la carga de trabajo del proceso.
- [Guía de telemetría e instrumentación](http://msdn.microsoft.com/library/dn589775.aspx). Instrumentación y telemetría son fundamentales para recopilar la información que puede conducir el proceso de ajuste automático.

## <a name="more-information"></a>Más información
- [Cómo ajustar el tamaño de una aplicación](./cloud-services/cloud-services-how-to-scale.md)
- [Cambiar automáticamente la escala de una aplicación con funciones Web, funciones de trabajo o máquinas virtuales de Windows](cloud-services-how-to-manage.md#linkresources)
- [Cómo: vincular un recurso a un servicio de nube](cloud-services-how-to-manage.md#linkresources)
- [Escalar recursos vinculados](./cloud-services/cloud-services-how-to-scale.md#scale-link-resources)
- [Biblioteca de administración de servicios de supervisión de Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring)
- [Administración del servicio de Azure API de REST](http://msdn.microsoft.com/library/azure/ee460799.aspx)
- [API de REST de Azure Administrador de recursos](https://msdn.microsoft.com/library/azure/dn790568.aspx)
- [Biblioteca de Microsoft Insights](https://www.nuget.org/packages/Microsoft.Azure.Insights/)
- [Operaciones de ajuste automático](http://msdn.microsoft.com/library/azure/dn510374.aspx)
- [Namespace Microsoft.WindowsAzure.Management.Monitoring.Autoscale](http://msdn.microsoft.com/library/azure/microsoft.windowsazure.management.monitoring.autoscale.aspx)
