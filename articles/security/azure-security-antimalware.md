<properties
   pageTitle="Antimalware de Microsoft para servicios de nube de Azure y máquinas virtuales | Microsoft Azure"
   description="Este artículo proporciona una introducción a la arquitectura de Microsoft Antimalware de Azure, incluidos los escenarios compatibles y configuraciones para habilitar, configurar e implementar protección para servicios de nube de Azure y máquinas virtuales. Trataremos configuración básica, administración y supervisión funcionalidad accesible a través de la administración de servicios de Microsoft Azure API, secuencias de comandos de PowerShell, el portal de Azure y Visual Studio."
   services="security"
   documentationCenter="na"
   authors="YuriDio"
   manager="swadhwa"
   editor=""/>

<tags
   ms.service="security"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="09/19/2016"
   ms.author="yurid"/>

#<a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a>Antimalware de Microsoft para servicios de nube de Azure y máquinas virtuales

El panorama de amenazas moderna para entornos de nube es muy dinámico, aumenta la presión sobre el negocio TI suscriptores para mantener la protección eficaz para cumplir con los requisitos de seguridad y cumplimiento de la nube. Microsoft Antimalware para servicios de nube de Azure y máquinas virtuales es la capacidad de protección en tiempo real gratuita que ayuda a identificar y eliminar virus, spyware y otro software malintencionado, puede configurar alertas cuando conoce software malintencionado o no deseado intenta instalarse o ejecutarse en los sistemas de Azure.

La solución se basa en la misma plataforma antimalware como Fundamentos de seguridad de Microsoft \[MSE\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune y Windows Defender para Windows 8.0 o superior. Microsoft Antimalware para Azure es una solución de agente único para aplicaciones y entornos de inquilinos, diseñados para ejecutarse en segundo plano sin intervención humana. Puede implementar protección según las necesidades de las cargas de trabajo de la aplicación, con ambos básica seguro de forma predeterminada o avanzadas de configuración personalizada, incluida la supervisión de antimalware.

Al implementar y habilitar Microsoft Antimalware para Azure para sus aplicaciones, están disponibles las siguientes características principales:

- **Protección en tiempo real** - supervisa la actividad de servicios en la nube y en máquinas virtuales de Windows para detectar y bloquear la ejecución de malware.
- **Análisis programado** : periódicamente realiza un análisis de destino para detectar malware, incluida la ejecución de forma activa programas.
- **Corrección de Malware** - automáticamente realiza una acción sobre malware detectado, como eliminar o poner en cuarentena archivos malintencionados y limpiar las entradas del registro malintencionado.
- **Actualizaciones de firma** : instala automáticamente las firmas de protección más recientes (definiciones de virus) para garantizar la protección está actualizada en una frecuencia predeterminada.
- **Actualizaciones del motor de Antimalware** : se actualiza automáticamente el motor de Antimalware de Microsoft.
- **Las actualizaciones de plataforma Antimalware** : se actualiza automáticamente la plataforma de Microsoft Antimalware.
- **Active protection** - informes metadatos de telemetría sobre amenazas detectadas y recursos sospechosos a Microsoft Azure para garantizar una respuesta rápida a la evolución panorama de amenazas, así como habilitar la entrega de firma sincrónico en tiempo real a través de Microsoft Active Protection System (MAPS).
- **Ejemplos de informes** : proporciona los informes y ejemplos con el servicio de Microsoft Antimalware para mejorar el servicio y habilitar la solución de problemas.
- **Exclusiones** : permite aplicaciones y los administradores del servicio para configurar determinados procesos, archivos y unidades impedir que protección y análisis de rendimiento y otras razones.
- **Recopilación de eventos de Antimalware** - registra el estado del servicio antimalware, actividades sospechosas y acciones de corrección realizadas en el registro de eventos del sistema operativo y ellos se recogen en la cuenta del cliente el almacenamiento de Azure.

> [AZURE.NOTE] También se puede implementar Microsoft Antimalware mediante el centro de seguridad de Azure. Para obtener más información, lea [Instalar Endpoint Protection en Centro de seguridad de Azure](../security-center/security-center-install-endpoint-protection.md) . 

##<a name="architecture"></a>Arquitectura

El Antimalware Microsoft para la solución de servicios de nube de Azure y máquinas virtuales de Windows incluye el servicio, modelo de implementación clásica Antimalware, cmdlets de Antimalware PowerShell y extensión de diagnósticos de Azure y el cliente de Antimalware de Microsoft. La solución Microsoft Antimalware es compatible con Windows Server 2008 R2, Windows Server 2012 y familias de sistemas operativos de Windows Server 2012 R2. No es compatible en el sistema operativo Windows Server 2008. En este momento, no se admite la vista previa técnica de Windows Server y se va a soporte de en el futuro.

El cliente de Antimalware de Microsoft y el servicio se instala en un estado deshabilitado en todas las familias de sistemas operativos invitados compatibles de Azure en la plataforma de servicios de nube de forma predeterminada. El cliente de Antimalware de Microsoft y servicio no está instalado de forma predeterminada en la plataforma de máquinas virtuales y está disponible como una característica opcional a través del portal de Azure y configuración de Visual Studio Virtual Machine en extensiones de seguridad.

Al utilizar sitios Web de Azure, el servicio subyacente que hospeda la aplicación web tiene Antimalware Microsoft habilitado en él. Esto se usa para proteger la infraestructura de sitios Web de Azure y no se ejecuta en contenido del cliente. 


###<a name="microsoft-antimalware-workflow"></a>Flujo de trabajo de Microsoft antimalware

El Administrador de Azure puede habilitar Antimalware para Azure con una configuración predeterminada o personalizada para su máquinas virtuales y servicios en la nube usando las siguientes opciones:

-   Máquinas virtuales en el portal de Azure en **Extensiones de seguridad**

-   Máquinas virtuales con la configuración de máquinas virtuales de Visual Studio en el Explorador de servidores

-   Máquinas virtuales y servicios en la nube – utiliza el [modelo de implementación clásico](https://msdn.microsoft.com/library/azure/ee460799.aspx) de Antimalware

-   Máquinas virtuales y servicios en la nube – cmdlets de Antimalware PowerShell usando

El portal de Azure o los cmdlets de PowerShell insertar el archivo de paquete de extensión Antimalware en el sistema de Azure en una ubicación fija predeterminado. El agente de invitado Azure (o el agente de tela) inicia la Antimalware extensión, aplicar las opciones de configuración de Antimalware proporcionadas como entrada. Este paso permite que el servicio de Antimalware con predeterminado o personalizado de configuración. Si no se proporciona ninguna configuración personalizada, el servicio de antimalware está habilitado con la configuración predeterminada. Consulte la sección *configuración de Antimalware* en el [Antimalware de Microsoft para los servicios de nube de Azure y máquinas virtuales: ejemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para Azure servicios en la nube y ejemplos de código de máquinas virtuales") para obtener más detalles.

Una vez que se ejecuta, el cliente de Microsoft Antimalware descarga las últimas definiciones de motor y la firma de protección de Internet y carga en el sistema de Azure. El servicio de Microsoft Antimalware escribe eventos relacionados con el servicio en el registro de eventos de sistema operativo de sistema en el origen de eventos "Microsoft Antimalware". Eventos incluyen el estado de mantenimiento del cliente de Antimalware, estado de protección y corrección, configuración nuevos y antiguos, actualizaciones del motor y definiciones de firma y otros usuarios.

Puede habilitar Antimalware supervisión para que el servicio de nube o máquina Virtual para que los eventos de registro de eventos de Antimalware escritos a medida que se generan a su cuenta de almacenamiento de Azure. El Antimalware Service usa la extensión de diagnósticos de Azure para recopilar eventos Antimalware desde el sistema de Azure en tablas de la cuenta del cliente el almacenamiento de Azure.

El flujo de trabajo de implementación incluidos los pasos de configuración y opciones compatibles para los casos anteriores figuran en la sección [escenarios de implementación de Antimalware](#_Antimalware_Deployment_Scenarios) de este documento.

![Microsoft Antimalware en Azure](./media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [AZURE.NOTE] Sin embargo, puede usar Powershell/API y plantillas de administrador de recursos de Azure implementar conjuntos de escala de máquina Virtual con la extensión de antimalware de Microsoft.  Para instalar una extensión en una máquina Virtual ya en ejecución, puede usar la de secuencia de comandos de python muestra *vmssextn.py* encuentra [aquí](https://github.com/gbowerman/vmsstools). Esta secuencia de comandos obtiene la configuración de extensión existente en el conjunto de escala y agrega una extensión a la lista de extensiones existentes en los conjuntos de escala de la máquina virtual.

###<a name="default-and-custom-antimalware-configuration"></a>De forma predeterminada y la configuración de Antimalware personalizado

La configuración predeterminada se aplica para habilitar Antimalware para servicios de nube de Azure o máquinas virtuales cuando no se proporcionan valores de configuración personalizados. La configuración predeterminada se ha previamente optimizada para ejecutar en el entorno de Azure. Si lo desea, puede personalizar estas opciones de configuración predeterminada según sea necesario para su aplicación para Azure o una implementación de servicio y aplicarlos para otros escenarios de implementación.

> [AZURE.NOTE] La interfaz de usuario de Antimalware de Microsoft en el Administrador de recursos de Azure está deshabilitada de forma predeterminada, no se admite el archivo [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) para omitir este mensaje de error. Para obtener información sobre cómo crear una directiva personalizada, lea [Habilitar interfaz de usuario de Microsoft Antimalware en máquinas virtuales de entrada de implementación de Azure recursos Manager](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/). 

La siguiente tabla resume las opciones de configuración disponibles para el servicio de Antimalware. La configuración predeterminada se marca en la columna con la etiqueta "Predeterminado" a continuación.

![Tabla 1](./media/azure-security-antimalware/sec-azantimal-tb18.PNG)

##<a name="antimalware-deployment-scenarios"></a>Escenarios de implementación de antimalware

En esta sección se describen los escenarios para habilitar y configurar antimalware, incluida la supervisión de servicios de nube de Azure y máquinas virtuales.

###<a name="virtual-machines---enable-and-configure-antimalware"></a>Máquinas virtuales - habilitar y configurar antimalware

**Implementación con el Portal de Azure**

Para habilitar el servicio de Antimalware, haga clic en **Agregar** en el módulo de extensiones, seleccione **Antimalware de Microsoft** en el nuevo módulo de recursos, haga clic en **crear** en el módulo Microsoft Antimalware. Haga clic en **crear** sin introducir los valores de configuración para habilitar Antimalware con la configuración predeterminada o escriba los valores de configuración de Antimalware para la máquina Virtual configurado tal como se muestra en la figura 2. Consulte la **información sobre herramientas** proporcionado con cada opción de configuración en el módulo de extensión Agregar para ver los valores de configuración compatible.

![Opciones de configuración de la máquina virtual de Microsoft Antimalware](./media/azure-security-antimalware/sec-azantimal-fig2.PNG)

**Implementación con el portal de clásico de Azure**

Para habilitar y configurar Microsoft Antimalware para Azure máquinas virtuales de Windows con el portal de Azure durante el aprovisionamiento de una máquina Virtual, siga los pasos siguientes:

1. Inicie sesión en el portal de Azure en <https://portal.azure.com>

2.haga para crear una nueva máquina virtual, haga clic en **nuevo**, **calcular**, **Virtual** **Machine**, **Desde la Galería** (no utilice crear rápido) como se muestra a continuación:

![Nueva máquina Virtual](./media/azure-security-antimalware/sec-azantimal-fig3.PNG)


3.en Seleccione la imagen de **Microsoft Windows Server** en la página **Elegir una imagen** .

4. Haga clic en la flecha derecha y la configuración de la máquina Virtual de entrada.

5. Active la casilla de **Antimalware de Microsoft** en **Extensiones de seguridad** en la página de configuración de la máquina Virtual.

6. Haga clic en el botón Enviar para habilitar y configurar Microsoft Antimalware para Azure máquinas virtuales de Windows con la configuración predeterminada.

![Configuración de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig4.PNG)

**Implementación mediante la configuración de la máquina virtual de Visual Studio**

Para habilitar y configurar el servicio de Microsoft Antimalware mediante Visual Studio:

1. conectar con Microsoft Azure en Visual Studio.

2.Haga elija su máquina Virtual en el nodo de **máquinas virtuales** en el **Explorador de servidores**

![Configuración de la máquina virtual en Visual Studio](./media/azure-security-antimalware/sec-azantimal-fig5.PNG)

3. Haga clic en **Configurar** para ver la página de configuración de máquina Virtual

4. Seleccione **Microsoft Antimalware** extensión en la lista desplegable en **Extensiones instaladas** y haga clic en **Agregar** para configurar con la configuración predeterminada de antimalware.

![Extensiones instaladas](./media/azure-security-antimalware/sec-azantimal-fig6.PNG)

5. para personalizar la configuración predeterminada de Antimalware, seleccione (resalte) el Antimalware extensión en la lista de extensiones instaladas y haga clic en **Configurar**.

6. reemplazar la configuración predeterminada de Antimalware con la configuración personalizada en formato JSON compatible en el cuadro de texto de **configuración pública** y haga clic en Aceptar.

7. Haga clic en el botón **Actualizar** para actualizar las actualizaciones de configuración en la máquina Virtual.

![Extensión de configuración de máquina virtual](./media/azure-security-antimalware/sec-azantimal-fig7.PNG)

**Nota:** La configuración de máquinas de Visual Studio para Antimalware admite solo la configuración de formato JSON. La plantilla de configuración de configuración de Antimalware JSON se incluye en [Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código"), que muestra las opciones de configuración de Antimalware compatibles.

**Cmdlets de PowerShell de uso de implementación**

Una aplicación de Azure o servicio puede habilitar y configurar Microsoft Antimalware para Azure máquinas virtuales de Windows mediante los cmdlets de PowerShell.

Para habilitar y configurar el uso de cmdlets de PowerShell antimalware de antimalware de Microsoft:

1. Configurar el entorno de PowerShell: consulte la documentación en <https://github.com/Azure/azure-powershell>

2. Use el cmdlet de conjunto AzureVMMicrosoftAntimalwareExtension Antimalware para habilitar y configurar Microsoft Antimalware de la máquina Virtual tal como se describe en <http://msdn.microsoft.com/library/azure/dn771718.aspx>

**Nota:** La configuración de máquinas virtuales de Azure para Antimalware admite solo la configuración de formato JSON. La plantilla de configuración de configuración de Antimalware JSON se incluye en [Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código"), que muestra las opciones de configuración de Antimalware compatibles.

###<a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a>Cmdlets de habilitar y configurar Antimalware usando PowerShell

Una aplicación de Azure o servicio puede habilitar y configurar Microsoft Antimalware para los servicios de nube de Azure con los cmdlets de PowerShell. Tenga en cuenta que Microsoft Antimalware se instala en un estado deshabilitado en la plataforma de servicios en la nube y requiere una acción por una aplicación de Azure habilitarlo.

Para habilitar y configurar Antimalware Microsoft usar cmdlets de PowerShell:

1.  Configurar el entorno de PowerShell: consulte la documentación en <https://github.com/Azure/azure-sdk-tools#get-started>

2.  Usar el cmdlet de conjunto AzureServiceAntimalwareExtension Antimalware para habilitar y configurar Microsoft Antimalware de su servicio de nube como se indica en <http://msdn.microsoft.com/library/azure/dn771718.aspx>

La plantilla de configuración de configuración de Antimalware XML se incluye en [Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código"), que muestra las opciones de configuración de Antimalware compatibles.

###<a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a>Máquinas virtuales - cmdlets de PowerShell de usar configuración de servicios de nube

Una aplicación de Azure o servicio puede recuperar la configuración de Microsoft Antimalware de servicios en la nube y máquinas virtuales con los cmdlets de PowerShell.

Para recuperar la configuración de Microsoft Antimalware usar cmdlets de PowerShell:

1.  Configurar el entorno de PowerShell: consulte la documentación en <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **Para el máquinas virtuales**: Use el cmdlet Get-AzureVMMicrosoftAntimalwareExtension Antimalware para obtener la configuración de antimalware tal como se describe en <http://msdn.microsoft.com/library/azure/dn771719.aspx>

3.  **Para los servicios de nube**: Use el cmdlet Get-AzureServiceAntimalwareConfig Antimalware para obtener la configuración de Antimalware tal como se describe en <http://msdn.microsoft.com/library/azure/dn771722.aspx>

###<a name="remove-antimalware-configuration-using-powershell-cmdlets"></a>Quitar los cmdlets de PowerShell de usar configuración de Antimalware

Una aplicación de Azure o servicio puede quitar la configuración de Antimalware y cualquier configuración de supervisión de Antimalware asociado de las extensiones de servicio relevantes de un Antimalware de Azure y diagnósticos asociadas con el servicio de nube o máquina Virtual.

Para quitar Antimalware Microsoft usar cmdlets de PowerShell:

1.  Configurar el entorno de PowerShell: consulte la documentación en <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **Para el máquinas virtuales**: usar el cmdlet AzureVMMicrosoftAntimalwareExtension quitar Antimalware tal como se describe en <http://msdn.microsoft.com/library/azure/dn771720.aspx>

3.  **Para los servicios de nube:** Usar el cmdlet AzureServiceAntimalwareExtension quitar Antimalware tal como se describe en <http://msdn.microsoft.com/library/azure/dn771717.aspx>

Para **Habilitar** la recopilación de eventos de antimalware para una máquina virtual con el Portal de vista previa de Azure:

1.  Haga clic en cualquier parte de la lente de supervisión en el módulo de máquina Virtual

2.  Haga clic en el comando de diagnóstico en el módulo métrico

3.  Seleccione el **estado de** activado y Active la opción para el sistema de eventos de Windows 
4.  . Puede elegir desactive todas las demás opciones en la lista, o dejar habilitados por sus necesidades de servicio de aplicación.

4.  Las categorías de eventos Antimalware "Error", "Advertencia", "Información", etc., se capturan en su cuenta de almacenamiento de Azure.

Eventos de antimalware se recopilan desde los registros del sistema de eventos de Windows a su cuenta de almacenamiento de Azure. Puede configurar la cuenta de almacenamiento para la máquina Virtual recopilar eventos Antimalware seleccionando la cuenta de almacenamiento apropiado.

![Métricas y diagnósticos](./media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [AZURE.NOTE] Para obtener más información acerca del registro de diagnóstico para Azure Antimalware, lea [Activar el registro de diagnóstico para Azure Antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).

###<a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a>Habilitar y configurar la supervisión de antimalware usar cmdlets de powerShell

Puede habilitar la colección de eventos de Microsoft Antimalware para el servicio de nube o máquina Virtual mediante Diagnósticos de Azure a través de los cmdlets de Antimalware PowerShell. La extensión de diagnósticos de Azure puede estar configurada para capturar los eventos del origen de registro de eventos de sistema "Microsoft Antimalware" a su cuenta de almacenamiento de Azure. Las categorías de eventos Antimalware "Error", "Advertencia", "Información", etc., se capturan en su cuenta de almacenamiento de Azure.

Para habilitar la recopilación de eventos de Antimalware a su cuenta de almacenamiento de Azure mediante cmdlets de PowerShell:

1.  Configurar el entorno de PowerShell: consulte <https://github.com/Azure/azure-sdk-tools#get-started>

2.  **Para el máquinas virtuales** - usar el cmdlet Antimalware AzureVMMicrosoftAntimalwareExtension conjunto con la opción de supervisión activado como documentado en <http://msdn.microsoft.com/library/azure/dn771716.aspx>

3.  **Para los servicios de nube** - usar el cmdlet Antimalware AzureServiceAntimalwareExtension conjunto con la opción de supervisión activado como documentado en <http://msdn.microsoft.com/library/azure/dn771718.aspx>

Puede ver los eventos brutos Antimalware consultando la tabla WADWindowsEventLogsTable en su cuenta de almacenamiento de Azure que ha configurado para habilitar la supervisión de Antimalware. Esto puede ser útil para validar que está trabajando Antimalware de recopilación de eventos, incluidos obtener información sobre el estado del servicio Antimalware. Para obtener más detalles, incluido el código de ejemplo sobre cómo extraer Antimalware eventos desde su cuenta de almacenamiento, consulte [Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código](http://aka.ms/amazsamples "Microsoft Antimalware para Azure servicios en la nube y Máquina Virtual - ejemplos de código").
